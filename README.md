# ชุดคำสั่งสำหรับจัดการบัญชีผู้ใช้ในระบบ workD

ชุดคำสั่งสำหรับจัดการบัญชีผู้ใช้ในระบบ workD โดยใช้ไรบรารี puppeteer ควบคุมเว็บบราวเซอร์
เพื่ออำนวยความสะดวกในการจัดการบัญชีผู้ใช้ อย่างไรก็ตาม ชุดคำสั่งนี้ใช้วิธีควบคุมเว็บบราวเซอร์
จึงมีความเสถียรน้อยกว่าชุดคำสั่งที่ใช้งาน API (ณ วันที่เขียนชุดคำสั่ง ระบบ workD ยังไม่มี API)
และอาจจะไม่สามารถใช้งานได้เมื่อมีการปรับเปลี่ยนส่วนต่อประสานกราฟิกกับผู้ใช้ในระบบ workD

## คุณสมบัติ

- ส่งออกบัญชีผู้ใช้ทั้งหมดออกเป็นไฟล์ csv (ไฟล์ get-users.js)
- นำเข้าบัญชีผู้ใช้จากไฟล์ csv (ไฟล์ import-users.js)

## ซอฟต์แวร์ที่ใช้

- nodejs 18
- npm 8
- puppeteer

## วิธีติดตั้ง

1. ใช้คำสั่ง `npm install`
2. ใช้ชุดคำสั่งที่ต้องการ และระบุ username/password ของผู้ดูแลระบบ

## ส่งออกบัญชีผู้ใช้ทั้งหมดออกเป็นไฟล์ csv

```
node get-users.js <ที่อยู่ไฟล์ที่จะบันทึก>.csv
```
## นำเข้าบัญชีผู้ใช้จากไฟล์ csv

```
node import-users.js <ที่อยู่ไฟล์ที่จะนำเข้า>.csv
```

**หมายเหตุ**: เมื่อนำเข้าเสร็จแล้ว ชุดคำสั่งจะบันทึกรายการผู้ใช้ที่นำเข้าสู่ระบบแล้วที่
`<ที่อยู่ไฟล์ที่จะนำเข้า>_imported.csv`

### รูปแบบไฟล์ csv ที่ต้องจัดเตรียม

| ชื่อคอลัมน์        | คำอธิบาย                          |
|-----------------|----------------------------------|
| username        | ชื่อผู้ใช้ (ไม่ต้องระบุ @domain.go.th)   |
| name_th         | ชื่อ (ภาษาไทย)                    |
| surname_th      | นามสกุล (ภาษาไทย)                |
| name_en         | ชื่อ (ภาษาอังกฤษ) (หากมี)           |
| surname_en      | นามสกุล (ภาษาอังกฤษ) (หากมี)       |
| tel             | หมายเลขโทรศัพท์ (หากมี)            |
| mobile          | หมายเลขโทรศัพท์มือถือ (หากมี)        |
| cid             | เลขประจำตัวประชาชน (หากมี)         |
| secondary_email | อีเมลสำรอง (หากมี)                 |
| note            | หมายเหตุ (หากมี)                  |
